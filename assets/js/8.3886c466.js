(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{364:function(t,a,s){"use strict";s.r(a);var n=s(44),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"hybrid-app-本质"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hybrid-app-本质"}},[t._v("#")]),t._v(" Hybrid app 本质")]),t._v(" "),s("p",[t._v("在原生 app 中使用 webview 作为容器来承载一个 web 页面")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/1/5/16f75a7d003f0a17~tplv-t2oaga2asx-watermark.awebp",alt:"image"}})]),t._v(" "),s("h2",{attrs:{id:"jsbridge"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jsbridge"}},[t._v("#")]),t._v(" JSBridge")]),t._v(" "),s("h3",{attrs:{id:"定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[t._v("#")]),t._v(" 定义")]),t._v(" "),s("p",[t._v("一座用 JavaScript 搭建起来的桥 一端是 web 一端是 Native")]),t._v(" "),s("h3",{attrs:{id:"目的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目的"}},[t._v("#")]),t._v(" 目的")]),t._v(" "),s("p",[t._v("让 Native 可以调用 web 的 JavaScript 代码 让 web 可以调用 Native 的原生代码")]),t._v(" "),s("h2",{attrs:{id:"相互调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#相互调用"}},[t._v("#")]),t._v(" 相互调用")]),t._v(" "),s("h3",{attrs:{id:"原生调用-web-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原生调用-web-方法"}},[t._v("#")]),t._v(" 原生调用 web 方法")]),t._v(" "),s("p",[t._v("原生端调用 web 端的 js 方法必须是挂载到 window 对象上的方法。")]),t._v(" "),s("p",[t._v("android 端")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Native调用js方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" isAutoUser "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mSpHelper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAutoUser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TextUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.Android: loadUrl (4.4-)")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用js中的JSBridge.trigger方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 该方法的弊端是无法获取函数返回值；")]),t._v("\n    mWebView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadUrl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"javascript:nativeFunctionUserLogin(\'"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.Android: evaluateJavascript (4.4+)")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 原生调用 JS 方法， 调用的必须是绑定到window上面的方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保存当前登录的用户名到 web")]),t._v("\n    mWebView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluateJavascript")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"javascript:nativeFunctionUserLogin(\'"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueCallback")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onReceiveValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//此处为 js 返回的结果")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("ios 端")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Objective-C")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webView evaluateJavaScript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"registerCallback(true)"')]),t._v(" completionHandler"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("nil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Swift")]),t._v("\nwebview"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringByEvaluatingJavaScriptFromString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"alert('NativeCall')\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"web-调用原生方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-调用原生方法"}},[t._v("#")]),t._v(" web 调用原生方法")]),t._v(" "),s("p",[t._v("web 调用原生的方法总共有三种")]),t._v(" "),s("ol",[s("li",[t._v("JS 上下文注入")]),t._v(" "),s("li",[t._v("弹窗拦截")]),t._v(" "),s("li",[t._v("URL Schema")])]),t._v(" "),s("p",[t._v("下面主要说 JS 上下文注入")]),t._v(" "),s("p",[t._v("构建 JSBridge 对象 这里提供的 JSBridge 的方法会被挂载到网页的 window 对象上，Android 与 IOS 分别拥有对应的挂载方式。分别对应是:苹果 UIWebview JavaScriptCore 注入、安卓 addJavascriptInterface 注入、苹果 WKWebView scriptMessageHandler 注入。")]),t._v(" "),s("h4",{attrs:{id:"android-注册给-web-端调用的方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#android-注册给-web-端调用的方法"}},[t._v("#")]),t._v(" android 注册给 web 端调用的方法")]),t._v(" "),s("p",[t._v("web 端调用原生的方法 使用 window.androidJSBridge.xxx xxx 是 MyJaveScriptInterface 里面的方法。例如 window.androidJSBridge.aliPay()")]),t._v(" "),s("p",[t._v("js 调用 Native 原生方法传递的参数必须是基本类型的数据 不能是引用数据类型。如果想传递对象需要使用 JSON.stringify()")]),t._v(" "),s("p",[t._v("android 在暴露给 web 端调用的方法能直接有返回值")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addJavascriptInterface")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyJaveScriptInterface")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"androidJSBridge"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MyJaveScriptInterface类里面的方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// js调用Native原生方法传递的参数必须是基本类型的数据 不能是引用数据类型")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果想传递对象需要使用JSON.stringify()")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@JavascriptInterface")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" aliPay "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" payJson"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  aliPayHelper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pay")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payJson"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"ios-注册给-web-端调用的方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ios-注册给-web-端调用的方法"}},[t._v("#")]),t._v(" ios 注册给 web 端调用的方法")]),t._v(" "),s("p",[t._v("web 端调用原生的方法 使用 window.webkit.messageHandlers.xxx 例如 window.webkit.messageHandlers.register() 与 android 不同的是这里的 JSBridge 名字是固定的 webkit.messageHandlers")]),t._v(" "),s("p",[t._v("js 调用 Native 原生方法传递的参数可以是基本类型和引用数据类型。如果方法需要传递参数 我们调用的方式还得改成 window.webkit.messageHandlers.xxx.postMessage(params)")]),t._v(" "),s("p",[t._v("ios 在暴露给 web 端调用的方法不能直接有返回值 如果需要有返回值需要再调用 web 端的方法来传递参数")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("pragma")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token expression"}},[t._v("mark "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  OC注册供JS调用的方法")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("addScriptFunction "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wkUserContentController "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webView configuration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userContentController"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wkUserContentController addScriptMessageHandler"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("self name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"register"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wkUserContentController addScriptMessageHandler"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("self name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wkUserContentController addScriptMessageHandler"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("self name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"logout"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("pragma")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token expression"}},[t._v("mark "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 注册方法")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("register")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("body "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     NSDictionary "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userDefaults setObject"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("dict objectForKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"password"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" forKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("dict objectForKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webView evaluateJavaScript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"registerCallback(true)"')]),t._v(" completionHandler"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("nil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"android-ios-的双向通讯对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#android-ios-的双向通讯对比"}},[t._v("#")]),t._v(" android ios 的双向通讯对比")]),t._v(" "),s("h3",{attrs:{id:"相同点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#相同点"}},[t._v("#")]),t._v(" 相同点")]),t._v(" "),s("ol",[s("li",[t._v("都是通过 WebView 来完成网页的加载")]),t._v(" "),s("li",[t._v("都是通过向 Window 注入对象的方式来提供可被 Web 端调用的方法")]),t._v(" "),s("li",[t._v("都可以直接使用 evaluateJavaScript 调用 Web 端挂载到 window 对象下的方法")])]),t._v(" "),s("h3",{attrs:{id:"不同点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不同点"}},[t._v("#")]),t._v(" 不同点")]),t._v(" "),s("ol",[s("li",[t._v("注入对象的不同： android 可以提供注入对象名。 ios 固定为 webkit")]),t._v(" "),s("li",[t._v("js 调用 Native 方式不同： android 可直接获取注入对象调用方法。而 ios 为相对固定的写法 使用 window.webkit\n.messageHandlers.方法名.postMessage(参数)")]),t._v(" "),s("li",[t._v("接受 web 端传递来的数据格式不同： android 只能接受基本数据类型，传递对象需要用到 JSON.stringify()方法。而 ios 可以接受任意类型的数据")]),t._v(" "),s("li",[t._v("返回值的不同：android 在 web 端可以直接接受 andriod 方法的返回值。而 ios 只能通过再次调用 web 端方法来传递值")])]),t._v(" "),s("h2",{attrs:{id:"接入方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接入方式"}},[t._v("#")]),t._v(" 接入方式:")]),t._v(" "),s("p",[t._v("在线 H5: 直接将项目部署于线上服务器，并由客户端在 HTML 头部注入对应的 Bridge。")]),t._v(" "),s("ul",[s("li",[t._v("优势: 接入/开发成本低，对 App 的侵入小；")]),t._v(" "),s("li",[t._v("劣势: 重度依赖网络，无法离线使用，首屏加载慢；")])]),t._v(" "),s("p",[t._v("内置离线包: 将代码直接内置于 App 中，即本地存储中，可由 H5 或者 客户端引用 Bridge。")]),t._v(" "),s("ul",[s("li",[t._v("优势: 首屏加载快，可离线化使用；")]),t._v(" "),s("li",[t._v("劣势: 开发、调试成本变高，需要多端合作，且会增加 App 包体积")])])])}),[],!1,null,null,null);a.default=e.exports}}]);