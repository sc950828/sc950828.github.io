<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ArrayBuffer | 苏纯的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/randy.jpg">
    <meta name="description" content="开发路上的点点滴滴">
    <meta name="keywords" content="苏纯，苏纯的博客，苏纯的个人博客，前端博客，前端个人博客，苏纯前端博客">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.b53da8c8.js" as="script"><link rel="preload" href="/assets/js/2.97b7d918.js" as="script"><link rel="preload" href="/assets/js/20.cdbcd7f1.js" as="script"><link rel="prefetch" href="/assets/js/10.6da24947.js"><link rel="prefetch" href="/assets/js/11.bcfab479.js"><link rel="prefetch" href="/assets/js/12.d126a851.js"><link rel="prefetch" href="/assets/js/13.c3527672.js"><link rel="prefetch" href="/assets/js/14.299ed27d.js"><link rel="prefetch" href="/assets/js/15.ebc0b664.js"><link rel="prefetch" href="/assets/js/16.649c41da.js"><link rel="prefetch" href="/assets/js/17.1279d78a.js"><link rel="prefetch" href="/assets/js/18.da0d895b.js"><link rel="prefetch" href="/assets/js/19.d5bf0528.js"><link rel="prefetch" href="/assets/js/21.aad5eb06.js"><link rel="prefetch" href="/assets/js/22.3c7dd8ad.js"><link rel="prefetch" href="/assets/js/23.a2992667.js"><link rel="prefetch" href="/assets/js/24.f98f4b86.js"><link rel="prefetch" href="/assets/js/25.0fb73402.js"><link rel="prefetch" href="/assets/js/26.59e23d19.js"><link rel="prefetch" href="/assets/js/27.8ad211b3.js"><link rel="prefetch" href="/assets/js/28.c8c02cbe.js"><link rel="prefetch" href="/assets/js/29.165b69e9.js"><link rel="prefetch" href="/assets/js/3.aea64a9a.js"><link rel="prefetch" href="/assets/js/4.1ec4d5f4.js"><link rel="prefetch" href="/assets/js/5.657d4fd9.js"><link rel="prefetch" href="/assets/js/6.3d277fb6.js"><link rel="prefetch" href="/assets/js/7.7f5ac9cb.js"><link rel="prefetch" href="/assets/js/8.7234a4cf.js"><link rel="prefetch" href="/assets/js/9.9fe0683b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">苏纯的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide.html" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="https://juejin.cn/user/3403743730867767/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide.html" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="https://juejin.cn/user/3403743730867767/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/HTML" class="sidebar-heading clickable"><span>HTML</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/CSS" class="sidebar-heading clickable"><span>CSS</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/JavaScript" class="sidebar-heading clickable router-link-active open"><span>JavaScript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/JavaScript/前端二进制一次性搞清楚.html" class="active sidebar-link">前端二进制一次性搞清楚</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#arraybuffer" class="sidebar-link">ArrayBuffer</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#typedarray" class="sidebar-link">TypedArray</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#dataview" class="sidebar-link">DataView</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#blob" class="sidebar-link">Blob</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#file" class="sidebar-link">File</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#base64" class="sidebar-link">Base64</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#filereader" class="sidebar-link">FileReader</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#相互转换" class="sidebar-link">相互转换</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#参考文章" class="sidebar-link">参考文章</a></li><li class="sidebar-sub-header"><a href="/JavaScript/前端二进制一次性搞清楚.html#后记" class="sidebar-link">后记</a></li></ul></li><li><a href="/JavaScript/都2022年了你不会还没搞懂JS数据类型吧.html" class="sidebar-link">都2022年了你不会还没搞懂JS数据类型吧</a></li><li><a href="/JavaScript/都2022年了你不会还没搞懂JS原型和继承吧.html" class="sidebar-link">都2022年了你不会还没搞懂JS原型和继承吧</a></li><li><a href="/JavaScript/都2022年了你不会还没搞懂JS赋值拷贝、浅拷贝、深拷贝吧.html" class="sidebar-link">都2022年了你不会还没搞懂JS赋值拷贝、浅拷贝、深拷贝吧</a></li><li><a href="/JavaScript/都2022年了你不会还没搞懂对象数组的遍历吧.html" class="sidebar-link">都2022年了你不会还没搞懂对象数组的遍历吧</a></li><li><a href="/JavaScript/都2022年了你不会还没搞懂this吧.html" class="sidebar-link">都2022年了你不会还没搞懂this吧</a></li><li><a href="/JavaScript/JSObjectAPI详解.html" class="sidebar-link">JS Object API详解</a></li><li><a href="/JavaScript/前端文件的上传和下载.html" class="sidebar-link">前端文件的上传和下载</a></li><li><a href="/JavaScript/js垃圾回收和内存泄露.html" class="sidebar-link">js垃圾回收和内存泄露</a></li><li><a href="/JavaScript/js执行上下文和执行机制一文说透.html" class="sidebar-link">js执行上下文和执行机制一文说透</a></li><li><a href="/JavaScript/js中关于事件的那些事一次性搞懂.html" class="sidebar-link">js中关于事件的那些事一次性搞懂</a></li><li><a href="/JavaScript/js异步编程.html" class="sidebar-link">js异步编程</a></li><li><a href="/JavaScript/节流、防抖一套带走.html" class="sidebar-link">节流、防抖一套带走</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="arraybuffer"><a href="#arraybuffer" class="header-anchor">#</a> ArrayBuffer</h2> <p><code>ArrayBuffer</code>对象代表储存二进制数据的一段内存，它不能直接读写，只能通过视图进行操作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建一个长度为 16 的 buffer 它会分配一个 16 字节（byte）的连续内存空间，并用 0 进行预填充。</span>
<span class="token keyword">const</span> buffer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="typedarray"><a href="#typedarray" class="header-anchor">#</a> TypedArray</h2> <p>TypedArray 是一组构造函数，一共包含九种类型，每一种都是一个构造函数。</p> <p>TypedArray 的构造函数接受三个参数，第一个 ArrayBuffer（其实还可以是数组、视图这里不细说）对象，第二个视图开始的字节号（默认 0），第三个视图结束的字节号（默认直到本段内存区域结束）。</p> <table><thead><tr><th style="text-align:center;">名称</th> <th style="text-align:center;">占用字节</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:center;">Int8Array</td> <td style="text-align:center;">1</td> <td style="text-align:center;">8 位有符号整数</td></tr> <tr><td style="text-align:center;">Uint8Array</td> <td style="text-align:center;">1</td> <td style="text-align:center;">8 位无符号整数</td></tr> <tr><td style="text-align:center;">Uint8ClampedArray</td> <td style="text-align:center;">1</td> <td style="text-align:center;">8 位无符号整型固定数组(数值在 0~255 之间)</td></tr> <tr><td style="text-align:center;">Int16Array</td> <td style="text-align:center;">2</td> <td style="text-align:center;">16 位有符号整数</td></tr> <tr><td style="text-align:center;">Uint16Array</td> <td style="text-align:center;">2</td> <td style="text-align:center;">16 位无符号整数</td></tr> <tr><td style="text-align:center;">Int32Array</td> <td style="text-align:center;">4</td> <td style="text-align:center;">32 位有符号整数</td></tr> <tr><td style="text-align:center;">Uint32Array</td> <td style="text-align:center;">4</td> <td style="text-align:center;">32 位无符号整数</td></tr> <tr><td style="text-align:center;">Float32Array</td> <td style="text-align:center;">4</td> <td style="text-align:center;">32 位 IEEE 浮点数</td></tr> <tr><td style="text-align:center;">Float64Array</td> <td style="text-align:center;">8</td> <td style="text-align:center;">64 位 IEEE 浮点数</td></tr></tbody></table> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Uint8Array —— 将 ArrayBuffer 中的每个字节视为 0 到 255 之间的单个数字（每个字节是 8 位）。这称为 “8 位无符号整数”。</span>
<span class="token comment">// Uint16Array —— 将每 2 个字节视为一个 0 到 65535 之间的整数。这称为 “16 位无符号整数”。</span>
<span class="token comment">// Uint32Array —— 将每 4 个字节视为一个 0 到 4294967295 之间的整数。这称为 “32 位无符号整数”。</span>
<span class="token comment">// Float64Array —— 将每 8 个字节视为一个 5.0x10-324 到 1.8x10308 之间的浮点数。</span>

<span class="token keyword">const</span> uint8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buffer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uint16 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint16Array</span><span class="token punctuation">(</span>buffer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uint32 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint32Array</span><span class="token punctuation">(</span>buffer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> float64 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float64Array</span><span class="token punctuation">(</span>buffer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="dataview"><a href="#dataview" class="header-anchor">#</a> DataView</h2> <p><code>DataView</code>  就是一种更灵活的视图，DataView 视图支持除 Uint8ClampedArray 以外的八种类型。DataView 比使用 TypedArray 更方便，只需要简单的创建一次就能进行各种转换。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 可以转成各种格式</span>
<span class="token keyword">const</span> dataView1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span>buffer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataView1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataView1<span class="token punctuation">.</span><span class="token function">getUint8</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataView1<span class="token punctuation">.</span><span class="token function">getUint16</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataView1<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataView1<span class="token punctuation">.</span><span class="token function">getFloat64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="blob"><a href="#blob" class="header-anchor">#</a> Blob</h2> <p><code>Blob</code>  对象表示一个不可变、原始数据的类文件对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 构造函数</span>
<span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>array 是一个由<code>ArrayBuffer, ArrayBufferView, Blob, DOMString</code> 等对象构成的数组，<code>DOMStrings</code>会被编码为 UTF-8。</p></li> <li><p>options 是一个可选，它可能会指定如下两个属性：</p> <ul><li>type，默认值为 <code>&quot;&quot;</code>，内容的 MIME 类型。</li> <li>endings，默认值为<code>&quot;transparent&quot;</code>，用于指定包含行结束符<code>\n</code>的字符串如何被写入。 它是以下两个值中的一个： <code>&quot;native&quot;</code>，代表行结束符会被更改为适合宿主操作系统文件系统的换行符，或者 <code>&quot;transparent&quot;</code>，代表会保持 blob 中保存的结束符不变</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> blob1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;hello randy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="实例属性、方法"><a href="#实例属性、方法" class="header-anchor">#</a> 实例属性、方法</h3> <h4 id="属性"><a href="#属性" class="header-anchor">#</a> 属性</h4> <ul><li><code>type</code> 类型 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types" target="_blank" rel="noopener noreferrer">常见的 MIME 类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>size</code> 大小、单位为字节</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;randy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出的对象有如下属性</span>
<span class="token comment">// size: 10;</span>
<span class="token comment">// type: &quot;text/plain&quot;;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h4> <ul><li><code>slice()</code> 从 <code>Blob</code> 中截取一部分并返回一个新的 <code>Blob</code>(用法同数组的 <code>slice</code>)</li> <li><code>arrayBuffer()</code> 返回一个以二进制形式展现的 <code>promise</code></li> <li><code>stream()</code> 返回一个<code>ReadableStream</code>对象</li> <li><code>text()</code> 返回一个文本形式的 <code>promise</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 转成stream</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blob<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 转成Arraybuffer</span>
blob<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 转成文本</span>
blob<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="blob-url"><a href="#blob-url" class="header-anchor">#</a> blob url</h3> <p>简单的理解一下就是将一个<code>file</code>或<code>Blob</code>类型的对象转为<code>UTF-16</code>的字符串，并保存在当前操作的<code>document</code>下，存储在内存中。</p> <p>类似这样一个链接</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>blob<span class="token operator">:</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span><span class="token number">53</span>acc2b6<span class="token operator">-</span>f47b<span class="token operator">-</span><span class="token number">450</span>f<span class="token operator">-</span>a390<span class="token operator">-</span>bf0665e04e59
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>生成 blob url 使用的方法是<code>URL.createObjectURL(file/blob)</code>。清除方式只有页面<code>unload()</code>事件或者使用<code>URL.revokeObjectURL(objectURL)</code>手动清除 。</p> <p>这在前端下载中经常会用到。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">downloadFile</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> fileName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 我们使用axios设置接口返回类型 responseType: &quot;blob&quot;, 所以这里从后端返回的是blob。</span>
  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">download</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token operator">+</span> <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">// 生成blob url。这里可以使用Blob对象或者File对象</span>
  a<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 释放内存</span>
  window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="file"><a href="#file" class="header-anchor">#</a> File</h2> <p><code>File</code>  描述文件信息的一个对象，可以让  <code>JavaScript</code>  访问文件信息。<code>File</code>  继承于  <code>Blob</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> name<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>array 是一个由<code>ArrayBuffer, ArrayBufferView, Blob, DOMString</code> 等对象构成，<code>DOMStrings</code>会被编码为 UTF-8。</p></li> <li><p>name 表示文件名称，或者文件路径。</p></li> <li><p>options 是一个可选，它可能会指定如下两个属性：</p> <ul><li>type，默认值为 <code>&quot;&quot;</code>，内容的 MIME 类型。</li> <li>lastModified: 数值，表示文件最后修改时间的 Unix 时间戳（毫秒）。默认值为 Date.now()。</li></ul></li></ul> <h3 id="实例属性、方法-2"><a href="#实例属性、方法-2" class="header-anchor">#</a> 实例属性、方法</h3> <h4 id="属性-2"><a href="#属性-2" class="header-anchor">#</a> 属性</h4> <ul><li><code>type</code> 类型 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types" target="_blank" rel="noopener noreferrer">常见的 MIME 类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>size</code> 大小、单位为字节</li> <li><code>name</code> 文件名称</li> <li><code>lastModified</code> 最后修改时间（时间戳）</li> <li><code>lastModifiedDate</code> 最后修改时间</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> file1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;文件对象&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出的对象有如下属性</span>
<span class="token comment">// lastModified: 1640589621358</span>
<span class="token comment">// lastModifiedDate: Mon Dec 27 2021 15:20:21 GMT+0800 (中国标准时间) {}</span>
<span class="token comment">// name: &quot;test&quot;</span>
<span class="token comment">// size: 12</span>
<span class="token comment">// type: &quot;text/plain&quot;</span>
<span class="token comment">// webkitRelativePath: &quot;&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="方法-2"><a href="#方法-2" class="header-anchor">#</a> 方法</h4> <ul><li><code>slice()</code> 从 <code>Blob</code> 中截取一部分并返回一个新的 <code>Blob</code>(用法同数组的 <code>slice</code>)</li> <li><code>arrayBuffer()</code> 返回一个以二进制形式展现的 <code>promise</code></li> <li><code>stream()</code> 返回一个<code>ReadableStream</code>对象</li> <li><code>text()</code> 返回一个文本形式的 <code>promise</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 转成stream</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file1<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 转成Arraybuffer</span>
file1<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 转成文本</span>
file1<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="base64"><a href="#base64" class="header-anchor">#</a> Base64</h2> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <p>Base64 是一种编码格式，在前端经常会碰到，格式是 <code>data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</code> 。</p> <p>除了使用工具进行 Base64 编码外，js 还内置了两个方法能进行字符串的 Base64 的编码和解码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> str1 <span class="token operator">=</span> <span class="token string">&quot;hello randy&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 编码</span>
<span class="token keyword">const</span> b1 <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aGVsbG8gcmFuZHk=</span>

<span class="token comment">// 解码</span>
<span class="token keyword">const</span> str2 <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">atob</span><span class="token punctuation">(</span>b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hello randy</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <ol><li>可以将二进制数据（比如图片）转化为可打印字符，方便传输数据。</li> <li>对数据进行简单的加密，肉眼是安全的。</li> <li>如果是在 html 或者 css 处理图片，可以减少 http 请求。</li></ol> <h3 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h3> <ol><li>内容编码后体积变大， 至少大 1/3。因为是三字节变成四个字节，当只有一个字节的时候，也至少会变成三个字节。</li> <li>编码和解码需要额外工作量。</li></ol> <h2 id="filereader"><a href="#filereader" class="header-anchor">#</a> FileReader</h2> <p>FileReader 对象允许 Web 应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容.</p> <h3 id="属性-3"><a href="#属性-3" class="header-anchor">#</a> 属性</h3> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>FileReader.error</td> <td>一个 DOMException，表示在读取文件时发生的错误 。</td></tr> <tr><td>FileReader.result</td> <td>返回文件的内容。只有在读取操作完成后，此属性才有效，返回的数据的格式取决于是使用哪种读取方法来执行读取操作的。</td></tr> <tr><td>FileReader.readyState</td> <td>表示 FileReader 状态的数字。0 还没有加载任何数据。1 数据正在被加载。2 已完成全部的读取请求。</td></tr></tbody></table> <h3 id="方法-3"><a href="#方法-3" class="header-anchor">#</a> 方法</h3> <p>需要注意的是 ，无论读取成功或失败，方法并不会返回读取结果，这一结果存储在 result 属性中。</p> <table><thead><tr><th>方法名</th> <th>描述</th></tr></thead> <tbody><tr><td>FileReader.abort()</td> <td>中止读取操作。在返回时，readyState 属性为 DONE。</td></tr> <tr><td>FileReader.readAsArrayBuffer()</td> <td>将读取的内容转成 ArrayBuffer。</td></tr> <tr><td>FileReader.readAsBinaryString()</td> <td>将读取的内容转成二进制数据。</td></tr> <tr><td>FileReader.readAsDataURL()</td> <td>将读取的内容转成并将其编码为 base64 的 data url。 格式是 <code>data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</code></td></tr> <tr><td>FileReader.readAsText()</td> <td>将数据读取为给定编码（默认为 utf-8 编码）的文本字符串。</td></tr></tbody></table> <h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <table><thead><tr><th>事件</th> <th>描述</th></tr></thead> <tbody><tr><td>FileReader.onabort</td> <td>处理 abort 事件。该事件在读取操作被中断时触发。</td></tr> <tr><td>FileReader.onerror</td> <td>处理 error 事件。该事件在读取操作发生错误时触发。</td></tr> <tr><td>FileReader.onload</td> <td>处理 load 事件。该事件在读取操作完成时触发。</td></tr> <tr><td>FileReader.onloadstart</td> <td>处理 loadstart 事件。该事件在读取操作开始时触发。</td></tr> <tr><td>FileReader.onloadend</td> <td>处理 loadend 事件。该事件在读取操作结束时（要么成功，要么失败）触发。</td></tr> <tr><td>FileReader.onprogress</td> <td>处理 progress 事件。该事件在读取 Blob 时触发。</td></tr></tbody></table> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> blob3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;randy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blob3<span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 通过fileReader获取结果</span>
  <span class="token comment">// fileReader.result 是结果（如果成功）</span>
  <span class="token comment">// fileReader.error 是 error（如果失败）。</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="相互转换"><a href="#相互转换" class="header-anchor">#</a> 相互转换</h2> <h3 id="blob-和-file-的互相转换"><a href="#blob-和-file-的互相转换" class="header-anchor">#</a> Blob 和 File 的互相转换</h3> <h4 id="blob-转-file"><a href="#blob-转-file" class="header-anchor">#</a> Blob 转 File</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> blob1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;blob文件&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// blob转file</span>
<span class="token keyword">const</span> file2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>blob1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> blob1<span class="token punctuation">.</span>type <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;file2: &quot;</span><span class="token punctuation">,</span> file2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="file-转-blob"><a href="#file-转-blob" class="header-anchor">#</a> File 转 Blob</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> file1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;文件对象&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// file转blob</span>
<span class="token keyword">const</span> blob2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>file1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> file1<span class="token punctuation">.</span>type <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;blob2: &quot;</span><span class="token punctuation">,</span> blob2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="file、blob、img-转-base64"><a href="#file、blob、img-转-base64" class="header-anchor">#</a> File、Blob、img 转 Base64</h3> <p>Blob 转 Base64</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Blob转Base64</span>
<span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;randy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;data:text/plain;base64,aGVsbG9yYW5keQ==&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>File 转 Base64</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// File转Base64</span>
<span class="token keyword">const</span> file1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;文件对象&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file1<span class="token punctuation">)</span><span class="token punctuation">;</span>

fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;data:text/plain;base64,5paH5Lu25a+56LGh&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>img 转 Base64</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 本地图片转base64，注意链接是本地链接不能是网络地址。</span>
<span class="token keyword">const</span> <span class="token function-variable function">img2base64</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">imgUrl</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> imgUrl<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> image<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
      canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> image<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
      <span class="token keyword">var</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span>width<span class="token punctuation">,</span> image<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> dataUrl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>dataUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">img2base64</span><span class="token punctuation">(</span><span class="token string">&quot;../vue2/src/assets/logo.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="base64-转-blob、file"><a href="#base64-转-blob、file" class="header-anchor">#</a> Base64 转 Blob、File</h3> <h4 id="base64-转-blob"><a href="#base64-转-blob" class="header-anchor">#</a> Base64 转 Blob</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">dataURLtoBlob</span><span class="token punctuation">(</span><span class="token parameter">dataurl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// `data:[&lt;mediatype&gt;][;base64],&lt;data&gt;`</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> dataurl<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    mime <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">:(.*?);</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    bstr <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    n <span class="token operator">=</span> bstr<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    u8arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    u8arr<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> bstr<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>u8arr<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> mime <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="base64-转-file"><a href="#base64-转-file" class="header-anchor">#</a> Base64 转 File</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">dataURLtoFile</span><span class="token punctuation">(</span><span class="token parameter">dataurl<span class="token punctuation">,</span> filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//将base64转换为文件</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> dataurl<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    mime <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">:(.*?);</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    bstr <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    n <span class="token operator">=</span> bstr<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    u8arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    u8arr<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> bstr<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>u8arr<span class="token punctuation">]</span><span class="token punctuation">,</span> filename<span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> mime <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> 参考文章</h2> <p><a href="https://juejin.cn/post/7028590772333051918" target="_blank" rel="noopener noreferrer">JavaScript 中 FileReader 对象详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6915795898609975309" target="_blank" rel="noopener noreferrer">Blob、ArrayBuffer、File、FileReader 和 FormData 的区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6973306727596818445" target="_blank" rel="noopener noreferrer">初探 Js 中的 Blob、ArrayBuffer、File 、FileRender、FormData<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="后记"><a href="#后记" class="header-anchor">#</a> 后记</h2> <p>本文为笔者个人学习笔记，如有谬误，还请告知，万分感谢！如果本文对你有所帮助，还请点个赞~~</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/CSS/css布局方案汇总.html" class="prev">
        css布局方案汇总
      </a></span> <span class="next"><a href="/JavaScript/都2022年了你不会还没搞懂JS数据类型吧.html">
        都2022年了你不会还没搞懂JS数据类型吧
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b53da8c8.js" defer></script><script src="/assets/js/2.97b7d918.js" defer></script><script src="/assets/js/20.cdbcd7f1.js" defer></script>
  </body>
</html>
