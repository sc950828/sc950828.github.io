<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      let obj = {
        count: 0,
        Gen(time) {
          return new Promise(function (resolve, reject) {
            setTimeout(function () {
              resolve({ done: false, value: time });
            }, time);
          });
        },
        [Symbol.asyncIterator]() {
          let self = this;
          return {
            next() {
              self.count++;
              if (self.count < 4) {
                return self.Gen(Math.random() * 1000);
              } else {
                return Promise.resolve({
                  done: true,
                  value: "",
                });
              }
            },
          };
        },
      };

      async function test() {
        for await (let item of obj) {
          console.log(Date.now(), item);
        }
      }

      test();
      // 1560093560200 649.3946561938179
      // 1560093560828 624.6310222512955
      // 1560093561733 901.9497480464518
    </script>
  </body>
</html>
